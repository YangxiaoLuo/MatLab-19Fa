%exm040405 

clear
t=[1980:2016].';							%		<2>
CH=[305350,290724,286729,307683,316666,...				%1980~1984
	312616,303340,330303,411923,461066,...
	398623,415604,495671,623054,566471,...				%1990~1994
	736870,867224,965320,1032576,1097133,...
	1214912,1344097,1477483,1671072,1966223,...			%2000~2004
	2308786,2774308,3571451,4604285,5121681,...
	6066351,7522103,8570348,9635025,10534526,...		%2010~2014
	11226186,11232108].'*1e-6;				%		<10>
US=[2862475,3210950,3345000,3638125,4040700,...		%1980~1984
	4346750,4590125,4870225,5252625,5657700,...
	5979575,6174050,6539300,6878700,7308775,...			%1990~1994
	7664050,8100175,8608525,9089150,9660625,...
	10284750,10621825,10977525,11510675,12274925,...	%2000~2004
	13093700,13855900,14477625,14718575,14418725,...
	14964400,15517925,16155250,16691500,17393100,...	%2010~2014
	18120700,18624450].'*1e-6;				%	<18>

tm=(t(end)+t(1))/2;					%
r=(t(end)-t(1))/2;					%
tt=(t-tm)/r;							%	<21>
n=3;									%			<22>
Pc=polyfit(tt,CH,n)					%	<23>
Pu=polyfit(tt,US,n)					%	<24>  

PCH=vpa(poly2sym(Pc),5)				%			<25>
PUS=vpa(poly2sym(Pu),5)				%			<26>  

Ty=(1980:2050)';						%
T=(Ty-tm)/r;							%		<26>
Vc=polyval(Pc,T);					%		<27>
Vu=polyval(Pu,T);					%		<28>
ym=max([Vc;Vu]);						%  

figure
hold on							%
tb=(t(end)+0.5-tm)/r;			%		<32>
fh=fill([tb,tb,T(end),T(end)],[0,ym,ym,0],'y',...			%	<33>
	'EdgeColor','none');		%
alpha(0.2)						%
plot([tb,tb],[0,ym],'--m','LineWidth',3)					%	<36>
									%
scatter(tt,CH,'r.');			%						<38>
scatter(tt,US,'bx');			%						<39>
ph=plot(T,Vc,'r',T,Vu,'--b');	%				<40>
hold off							%
box on								%
grid on,grid minor				%
axis([T(1),T(end),0,ym])		%
TL=1980:5:2050;					%
tL=(TL-tm)/r;						%				<46>
xticks(tL);						%						<47>
xticklabels(string(TL))			%			<48>
xtickangle(90)					%使
legend([ph(1),ph(2)],'China','USA','Location','NorthWest')%	<50>
									%
text(T(12),100,{'   1980 ~ 2016','统计数据拟合区'})	%分行注释	<52>
									%
text(T(45),100,{'   2017 ~ 2050','拟合曲线延伸区'})	%分行注释	<54>
									%
xlabel('年'),ylabel('万亿美元')
title('中美两国GDP统计拟合曲线及延伸')



